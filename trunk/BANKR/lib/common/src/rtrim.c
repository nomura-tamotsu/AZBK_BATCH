/*==========================================================================*/
/* COPYRIGHT Brainy Works LTD.                                              */
/* LICENSED MATERIAL - PROGRAM PROPERTY OF Brainy Works                     */
/*==========================================================================*/
/*																			*/
/* SYSTEM			 : Marketbrain											*/
/*																			*/
/* PROGRAM NAME      : Common Subroutine                                    */
/*                                                                          */
/* MODULE NAME       : rtrim.o     						                    */
/*                                                                          */
/* FUNCTION          : Send error message to error logging process.         */
/*                                                                          */
/* CALLING MODULE    : All Programs.                                        */
/*                                                                          */
/* CALLED MODULE     : None										            */
/*                                                                          */
/* ENTRY POINT       : rtrim              	                                */
/*																			*/
/* Mod	 yy/mm/dd	Coder			Comment									*/
/*-----+----------+---------------+-----------------------------------------*/
/* %00 | 01/08/02 | M.Hidaka	  | First Eddition.(UFJ様向け)				*/
/* %01 | 10/05/24 | K.Miyahara    | (WIN)符号拡張対応						*/
/*==========================================================================*/

/*--------------------------------------------------------------------------*/
/*	#1						 INCLUDE STATEMENTS								*/
/*--------------------------------------------------------------------------*/
#include <stdio.h>
#include <stdlib.h>
/* (%WIN) 2004/01/19 */
#include <string.h>

/*--------------------------------------------------------------------------*/
/*	#2						 DEFINE STATEMENTS								*/
/*--------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------*/
/*	#3						 EXTERNAL DECLARES								*/
/*--------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------*/
/*	#4						STRUCT DECLARATIONS								*/
/*--------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------*/
/*	#5						 SUBROUTNE DEFINITION							*/
/*--------------------------------------------------------------------------*/

/****************************************************************************/
/*																			*/
/*							  PROCEDURE DIVISION							*/
/*																			*/
/****************************************************************************/


void rtrim( char *pmsg )
{
	int len;
	int i;

	len = strlen( pmsg );
	for ( i = len - 1; i >= 0; i-- )
	{
		if ( pmsg[i] == ' ' || pmsg[i] == 0x0a || pmsg[i] == 0x0d )
		{
			pmsg[i] = '\0';
		}
		else if ( pmsg[i] == 0x40 )
		{
			if ( i != 0 )
			{
				/* VCでは「char」は「signed char」で扱われるため	*/
				/* '0x80'以降は「unsigned char」でキャスト			*/
				if ( (unsigned char)pmsg[i-1] == 0x81 )
				{
					/* (%WIN) 2005/01/19
					 pmsg[i]   == '\0';
					 pmsg[i-1] == '\0';					
					 */
					 pmsg[i]   = '\0';
					 pmsg[i-1] = '\0';
					 
					 i--;
				}
			}
		}
		else
		{
			break;
		}
	}
}


